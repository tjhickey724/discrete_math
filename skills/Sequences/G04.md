# G04: Sequences: Closed Forms for Linear Recurrences


* [Skill Description](#skill-description)
* [Sample Problems](#Sample-Problems)
* [Skill Tutorial](#Tutorial)
* [Answers to Sample Problems](#Answers)
* [Further Reading](#Reading)

---


# Skill Definition
The ability to find a closed form for a homogenous linear recurrence with constant coefficients. This involves find and solving the characteristic equation and using polyomial fitting.



---

# Sample-Problems

## Problem 1
Find the closed form for the recurrence defined by

$s_0=2$, $s_1=1$ and

$s_n = s_{n-1} + 6 s_{n-2}$ for all $n\ge 2$



## Problem 2
Find the closed form for the recurrence defined by

$s_0=1$ $s_1=6$

$s_n = 6 s_{n-1} - 9s_{n-2}$ for all $n\ge 2$


---

# Tutorial

## Exponential Sequences

Exponential sequences occur frequently in Computer Science and they are most often generated by recurrence relations.
In this note we will learn how to use recurrence relations to calculate elements of a series and we will learn to use the characteristic polynomial technique to find a closed form for such sequences.

## Linear Recurrence Relations
A recursive definition of a sequence $s=(s_0,s_1,s_2,\ldots)$ consists of
* some initial conditions giving the values of $s_0$ and possibly a few other initial values of $s$, e.g. $s_1, s_2$
* a recurrence relations which expresses $s_n$ for $n$ bigger than some initial value (typically 1) in terms of the
  values of $s_i$ for $i\lt n$, e.g. $s_{n-1}, s_{n-2}$, etc.

### Example 1
The triangle numbers are defined by
* $s_0=0$
* $s_n = s_{n-1} + n$ for $n\ge 1$

So
* $s_0 = 0$
* $s_1 = s_0+1 = 0+1 = 1$
* $s_2 = s_1+2 = 1+2=3$
* $s_3 = s_2 + 3 = 3+3 = 6$

We have seen that if the recurrence relation has the form $s_n = s_{n-1}+ q(n)$ for a polynomial $q$ of degree d, 
then we can use polynomial fitting to find a closed form for $s$ as a polynomial of degree $d+1$.

### Example 2
The Fibonacci numbers are defined by
* $s_0 = 0$
* $s_1 = 1$
* $s_n = s_{n-1} + s_{n-2}$ for all $n\ge 2$

So $s = (0,1,1,2,3,5,8,13,21,34,55,89,\ldots)$

### Example 3
Calculate the first 6 elements of the series defined by
* $s_0 = 0$
* $s_1 = 1$
* $s_n = 3s_{n-1} - 2 s_{n-2}$ for all $n\ge 2$

$s = (0,1,3,7,15,31,\ldots)$


## The Characteristic Polynomial Method
For a sequence defined recursively with a recurrence definition of the form
* $s_n = a_1 s_{n-1} + a_2 s_{n-2} + \ldots + a_k s_{n-k}$

The closed form for $s_n$ will have the form

$$
s_n \  = \ \alpha_1 \beta_1^n +  \alpha_2 \beta_2^n + \ldots +  \alpha_k \beta_k^n
$$

where $\beta_1,\ldots,\beta_k$ are the roots of the **characteristic polynomial**
* $x^k - a_1 x^{k-1} - a_2 x^{k-2} - \ldots - a_k x^0$

The $\beta_i$ are obtained by factoring the characteristic polynomial:
* $x^k - a_1 x^{k-1} - a_2 x^{k-2} - \ldots - a_k x^0 = (x-\beta_1) * (x-\beta_2) * \ldots *  (x-\beta_k)$

This holds only if the roots are distinct (i.e. $\beta_i\ne\beta_j$ for $i\ne j$.
If $\beta_i$ appears $r_i$ times, in the factorization then the closed form has the following shape:

$$
s_n \  = \ p_1(n) \beta_1^n +  p_2(n) \beta_2^n + \ldots +  p_k(n) \beta_k^n
$$

where each $p_i$ is a polynomial of degree $r_i$.

In practices we'll usually only look at quadratic polynomials in which case the characteristic polynomial has the form:
* $x^2 - a_1 x - a_2  = (x-\beta_1) * (x-\beta_2)$

and the closed form has the shape:
* $s_n \  = \ \alpha_1 \beta_1^n +  \alpha_2 \beta_2^n$ if $\beta_1 \ne \beta_2$
* $s_n \  = \ (\alpha_1 n + \alpha_2) \beta^n$ if $\beta_1 = \beta_2 = \beta$

The roots of a quadratic $x^2 - a_1 x - a_2 =0$ can be found using the quadratic formula:
* $d = a_1^2+4a_2$
* if $d=0$ then there is one root, $x=(a_1/2)$
* otherwise there are two roots $x=(a_1+\sqrt{d})/2$ and $x=(a_1-\sqrt{d})/2$
* if $d<0$ these two roots are both complex numbers, if $d>0$ they are real numbers.


## Finding a closed form
We can find the coefficients $\alpha_i$ by solving systems of linear equations, just as we did with polyomial sequences.
Let's look at an example using the recursive definition in Example 3 above:
* $s_0 = 0$
* $s_1 = 1$
* $s_n = 3s_{n-1} - 2 s_{n-2}$ for all $n\ge 2$

The characteristic equation is
* $x^2 -3x + 2 = (x-2)*(x-1)$

So the closed form has the shape:
* $s_n = \alpha_1 * 2^n + \alpha_2 * 1^n$

We can find the coefficients by using the same approach as for polynomial fitting:

|n | s(n) | linear expression in $\alpha_i$ | simplifies as |
| --- | --- | ---| --- |
| 0 | 0 | $\alpha_1 * 2^0 + \alpha_2 * 1^0$ | $\alpha_1 + \alpha_2 = 0$ |
| 1 | 1 | $\alpha_1 * 2^1 + \alpha_2 * 1^1$ | $2 \alpha_1 + \alpha_2 = 1$ |
| 2 | 3 | $\alpha_1 * 2^2 + \alpha_2 * 1^2$ | $4 \alpha_1 + \alpha_2 = 3$ |

The first equation gives us $\alpha_2 = -\alpha_1$ and if substitute that into the second equation we get
* $1 = 2 \alpha_1 + \alpha_2 = 2 \alpha_1 - \alpha_1 = \alpha_1$

So the closed form is
* $s_n = 2^n - 1$

### Example 4
Let's apply this for the Fibonacci sequence, which give a more complex result...
The recursion equation is 
* $s_n = s_{n-1} + s_{n-2}$

So the characteristic equation is 
* $x^2 -x -1=0$  with $a_1=a_2=1$

The roots of this equation are
* $\beta_1 = (1+\sqrt{5})/2 = 1.6180...$
* $\beta_2 = (1-\sqrt{5})/2 = -0.6180...$

so we can solve for $\alpha_1$ and $\alpha_2$ in the closed form
* $s_n \  = \ \alpha_1 \beta_1^n +  \alpha_2 \beta_2^n$

| n | $s_n$ | closed form | simplified equation|
| --- | --- | --- | --- |
| 0 | $\alpha_1 \beta_1^0 +  \alpha_2 \beta_2^0$ | $\alpha_1+  \alpha_2 =0$ |
| 1 | $\alpha_1 \beta_1^1 +  \alpha_2 \beta_2^1$ | $\alpha_1 \beta_1 + \alpha_2 \beta_2 =1$ |

We can solve these two equations by letting $\alpha_2 = -\alpha_1$ and so
* $1 = \alpha_1 \beta_1 - \alpha_1 \beta_2 = \alpha_1 (\beta_1 - \beta_2)$
* $\ \  = \alpha_1 ((1+\sqrt{5})/2 - (1-\sqrt{5})/2) = \alpha_1\sqrt{5}$
* so $\alpha_1 = 1/\sqrt{5}$ and
* $s_n = (1/\sqrt{5})*(\beta_1^n - \beta_2^n)$ which gives a formula for the nth Fibonacci number!

## Example 5
Lets look at the sequence defined by
* $s_0 = 0$
* $s_1 = 1$
* $s_n = 4s_{n-1} - 4 s_{n-2} = 4(s_{n-1} - s_{n-2})$ for all $n\ge 2$

so $s = (0, 1, 4, 12, 32, 80, ...)$

The characteristic equation is $x^2-4x+4 = (x-2)^2$
so the solution has the form
* $s_n = (an+b)2^n$

Plugging in values for n=0,1 we get
* $a * 0 + b = 0$ so b=0
* $(a*1+b)*2^1 = 1$ so a = 1/2

so $s_n = (n/2) * 2^n = n * 2^{n-1}$

This process of finding the parameters of a closed form by using the initial values is a key skill
needed when working with sequences.



---

# Tutorial

---

# Answers

## Problem 1
Find the closed form for the recurrence defined by

$s_0=2$, $s_1=1$ and

$s_n = s_{n-1} + 6 s_{n-2}$ for all $n\ge 2$



## Problem 2
Find the closed form for the recurrence defined by

$s_0=1$ $s_1=6$

$s_n = 6 s_{n-1} - 9s_{n-2}$ for all $n\ge 2$


---

# Reading



